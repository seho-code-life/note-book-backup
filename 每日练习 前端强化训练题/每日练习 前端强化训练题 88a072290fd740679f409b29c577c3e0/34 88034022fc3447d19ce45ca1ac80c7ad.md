# 34

# 34

Standards模式和Quirks模式有什么区别？

一个是标准模式一个是怪异模式

标准模式是遵循w3c的一种规范的浏览器渲染模式，怪异模式是为了兼容各个浏览器不同的规范的一种模式

标准模式下，宽度是内容本身，怪异模式是内容+padding+border

通过 CSS 的 {box-sizing: border-box;} 来对盒模型进行设置。

浏览器默认的是标准模式，但是怪异模式更符合人的直觉，所以大部分都会使用怪异模式来进行开发；

浏览器是怎样判断元素是否和某个CSS选择器匹配？

首先浏览器会在文档加载完毕之后，把所有的元素放到一个集合中，这个集合是从最后一个索引产生，匹配选择器的时候，会通过从右到左的选择器顺序去集合从下到上的顺序去查找，如果没找到就把元素从集合中删除，指导最后一个元素剩下来才是我们要找的

举一个例子

div.ready #wrapper > .bg-red

先把所有元素 class 中有 bg-red 的元素拿出来组成一个集合，然后上一层，对每一个集合中的元素，如果元素的 parent id 不为 #wrapper 则把元素从集合中删去。 再向上，从这个元素的父元素开始向上找，没有找到一个 tagName 为 div 且 class 中有 ready 的元素，就把原来的元素从集合中删去。

至此这个选择器匹配结束，所有还在集合中的元素满足。大体就是这样，不过浏览器还会有一些奇怪的优化。

1、为什么从后往前匹配因为效率和文档流的解析方向。效率不必说，找元素的父亲和之前的兄弟比遍历所哟儿子快而且方便。关于文档流的解析方向，是因为现在的 CSS，一个元素只要确定了这个元素在文档流之前出现过的所有元素，就能确定他的匹配情况；应用在即使 html 没有载入完成，浏览器也能根据已经载入的这一部分信息完全确定出现过的元素的属性。

2、为什么是用集合主要也还是效率。基于 CSS Rule 数量远远小于元素数量的假设和索引的运用，遍历每一条 CSS Rule 通过集合筛选，比遍历每一个元素再遍历每一条 Rule 匹配要快得多。